# AI News Assistant Bot

Telegram-бот для канала @ai_dlya_doma — автоматическая генерация постов об AI-инструментах для дома и быта.

## Что делает бот

1. **Собирает новости** из 15 RSS-источников (TechCrunch, VentureBeat, The Verge, Wired, Habr и др.)
2. **Классифицирует** через Claude AI — отбирает релевантные для целевой аудитории
3. **Генерирует посты** (700-900 символов) с картинками
4. **Отправляет на модерацию** — ручное одобрение перед публикацией
5. **Публикует в Telegram** после одобрения

## Статус: Production (Phase 3)

Бот работает на VPS-сервере 24/7 с системой модерации.

**Feature Flags:**
- `USE_MODERATION=true` — ручное одобрение постов ✅
- `USE_RUBRICS=false` — генерация по рубрикам (в разработке)
- `USE_NEW_SCHEDULE=false` — недельное расписание (в разработке)

## Интерфейс бота

### Постоянная клавиатура

```
┌─────────────┬─────────────┐
│ 📋 Очередь  │ 📊 Статистика│
├─────────────┼─────────────┤
│ 🔄 Обновить │ ⚙️ Настройки │
└─────────────┴─────────────┘
```

### Inline-кнопки модерации

Под каждым постом в очереди:

```
┌─────────────────┬────────────────┐
│ ✅ Опубликовать │ 📅 Отложить    │
├─────────────────┼────────────────┤
│ ✏️ Редактировать│ ❌ Отклонить   │
└─────────────────┴────────────────┘
```

## Команды бота

| Команда | Описание |
|---------|----------|
| `/start` | Показать клавиатуру |
| `/generate` | Сгенерировать посты |
| `/stats` | Статистика |
| `/help` | Список команд |

## Деплой

**Бот работает на VPS, НЕ локально!**

- **IP:** 141.227.152.143
- **Путь:** `/opt/news-assistant-bot/`
- **Сервис:** `ai-news-bot`

### После изменений в коде:

```bash
# 1. Загрузить файлы
scp "D:\AI\projects\news-assistant-bot\src\<file>.py" root@141.227.152.143:/opt/news-assistant-bot/src/

# 2. Перезапустить
ssh root@141.227.152.143 "systemctl restart ai-news-bot"

# 3. Проверить
ssh root@141.227.152.143 "systemctl status ai-news-bot"

# 4. Закоммитить
git add . && git commit -m "описание" && git push
```

### Логи:
```bash
ssh root@141.227.152.143 "journalctl -u ai-news-bot -f"
```

## Структура

```
news-assistant-bot/
├── scheduler.py              # Точка входа
├── src/
│   ├── post_generator.py     # Классификация и генерация постов
│   ├── telegram_bot.py       # Обработка команд + модерация
│   ├── moderation.py         # Система одобрения постов
│   ├── rubrics.py            # Рубрики и шаблоны
│   ├── rss_parser.py         # Парсинг RSS
│   ├── post_queue.py         # Очередь постов
│   └── database.py           # SQLite база
├── config/
│   ├── rss_feeds.json        # 15 RSS источников
│   ├── content_plan.yaml     # Недельное расписание
│   ├── prompts.yaml          # Шаблоны промптов
│   └── thresholds.yaml       # Лимиты и пороги
├── data/                     # База данных
└── logs/                     # Логи
```

## Ключевые параметры

| Параметр | Файл | Значение |
|----------|------|----------|
| Длина поста | `src/post_generator.py` | 700-900 символов |
| Telegram caption лимит | — | 1024 символа |
| Модель классификации | `src/post_generator.py` | `claude-3-haiku` |
| Модель генерации | `src/post_generator.py` | `claude-sonnet-4` |
| Порог классификатора | `src/post_generator.py` | `>= 45` |

## Workflow модерации

```
1. Бот генерирует посты → статус "pending_approval"
2. Владелец получает уведомление
3. Нажимает 📋 Очередь → видит посты с кнопками
4. ✅ Опубликовать → пост идёт в канал
5. 📅 Отложить → выбор времени публикации
6. ✏️ Редактировать → изменение текста
7. ❌ Отклонить → удаление из очереди
```

## Репозиторий

https://github.com/andrey-dev-ai/news-assistant-bot
